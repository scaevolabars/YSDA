\begin{prb}[Кострикин 8.2 е]
Исследуйте систему и найдите общее решение в зависимости от параметра:\\

\begin{gather*}
\begin{cases}
\lambda x_1 +  x_2 + x_3 &= 1 \\
 x_1 +  \lambda x_2 + x_3 &= 1 \\
 x_1 +  x_2 + \lambda x_3 &= 1 \\
\end{cases}
\end{gather*}

\end{prb}

\begin{sol}
\begin{gather*}
    \left(\begin{array}{c c c|c}
        \lambda & 1 & 1 & 1\\
        1 & \lambda & 1 & 1\\
        1 & 1 & \lambda & 1\\
    \end{array}\right)
    \sim
    \left(\begin{array}{c c c|c}
    1 & \lambda & 1 & 1 \\
    \lambda & 1 & 1 & 1 \\
    1 & 1 & \lambda & 1 \\
    \end{array}\right)
    \sim
    \left(
    \begin{array}{ccc|c}
     1 & \lambda & 1 & 1 \\
     0 & 1  - \lambda^2 & 1 - \lambda & 1 - \lambda \\
     0 & 1 - \lambda & \lambda - 1 & 0 \\
    \end{array}
    \right)
\end{gather*}

При $\lambda = 1$ система имеет решение $x_1 = 1 - x_2 -x_3$

\begin{gather*}
    \lambda \neq 1 \\
    \left(
    \begin{array}{ccc|c}
     1 & \lambda & 1 & 1 \\
     0 & 1  - \lambda^2 & 1 - \lambda & 1 - \lambda \\
     0 & 1 - \lambda & \lambda - 1 & 0 \\
    \end{array}
    \right) \sim 
    \left(
    \begin{array}{ccc|c}
     1 & \lambda & 1 & 1 \\
     0 & 1  + \lambda & 1 & 1 \\
     0 & 1 & -1 & 0 \\
    \end{array}
    \right) \sim
     \left(
    \begin{array}{ccc|c}
     1 & \lambda & 1 & 1 \\
     0 & 0 & \lambda + 2 & 1\\\
     0 & 1 & -1 & 0 \\
    \end{array}
    \right)
\end{gather*}

По теореме Кронекера-Каппели при $\lambda = -2$ система не совместна

\begin{gather*}
    \lambda \neq -2, \lambda \neq 1\\
    \left(
    \begin{array}{ccc|c}
     1 & \lambda & 1 & 1 \\
     0 & 1 & -1 & 0 \\
     0 & 0 & 1 & \frac{1}{\lambda + 2}\\
    \end{array}
    \right)
\end{gather*}
$x_1 = x_2 = x_3 = \frac{1}{\lambda + 2}$
\qed
\end{sol}

\begin{prb}
Найдите многочлен третьей степени $f(x)$ такой, что
\begin{gather*}
    f(0) = -1 \quad 
    f(1) = 1 \quad
    f(-1) = -7 \quad
    f'(1) = 6
\end{gather*}
\end{prb}

\begin{sol}
\begin{gather*}
   \left. f(0) = a_4 + a_3 x + a_2 x^2 + a_1 x^3 \right\vert_{x = 0} = a_4 = -1 \\
   f(1) = a_4 + a_3 + a_2 + a_1 = 1 \\
   f(-1) = a_4 - a_3 x + a_2 -  a_1 = -7 \\
   f'(1) =  a_3 + 2 a_2 + 3 a_3  = 6
\end{gather*}

\begin{gather*}
    \left(
    \begin{array}{cccc|c}
     1 & 1 & 1 & 1 & 1 \\
     1 & -1 & 1 & -1 & -7 \\
     0 & 1 & 2 & 3 & 6 \\
     1 & 0 & 0 & 0 & -1 \\
    \end{array}
    \right)
\end{gather*}

Решая систему получаем $\left(a_4, a_3, a_2, a_1\right) = \left(-1, 1, -2, 3\right)$
\qed
\end{sol}

\begin{nb}

\begin{gather*}
    \left(
    \begin{array}{cc}
    1 & n \\
    0 & 1
    \end{array}
    \right)
    \cdot
    \left(
    \begin{array}{cc}
    1 & m \\
    0 & 1
    \end{array}
    \right) =
    \left(
    \begin{array}{cc}
    1 & n + m \\
    0 & 1
    \end{array}
    \right)
\end{gather*}
\end{nb}

\begin{prb}
Докажите, что $\left(E +  x E_{ij}\right)^k = E +  k x E_{ij}$ при $i \neq j$
\end{prb}

\begin{sol}
Докажем по индукции:
База индукции тривиальна

Предположим, что $\left(E +  x E_{ij}\right)^n = E +  n x E_{ij}$

Докажем, что $\left(E +  x E_{ij}\right)^{n + 1} = E +  (n + 1 )x E_{ij}$

\begin{gather*}
    \left(E +  x E_{ij}\right)^{n + 1} = \left(E +  x E_{ij}\right)^{n} \left(E +  x E_{ij}\right) = \left(E +  n x E_{ij}\right) \left(E +  x E_{ij}\right) = E + (n + 1) x E_{ij} + nx E_{ij}E_{ij} 
\end{gather*}

Слагаемое $nx E_{ij}E_{ij}$ равно нулю если $i \neq j$ \qed

\end{sol}

\begin{prb}
Доказать что $E_{ij}E_{pq} =  \delta_{jp} E_{iq}$
\end{prb}

\begin{sol}
Прямым вычислением можно убедиться, что 

   \begin{align*}
        E_{ij}E_{pq}=\left\{
        \begin{array}{ll}
        E_{iq} & j = p\\
        0 & j\neq p
        \end{array}\right.
        = \delta_{jp}E_{iq}
    \end{align*} 
   
\end{sol}

\begin{prb}
Опишите множество матриц коммутирующих со всеми матрицами
\end{prb}

\begin{sol}
\begin{gather*}
    E_{ij}E_{pq} =  \delta_{jp} E_{iq}\\
    \mbox{Разложим произвольную матрицу по стандартному базису единичных матриц}\\
    A = \sum_{1 \leq i,j \leq n} a_{ij} E_{ij}\\
    A E_{pq} = E_{pq} A  \leftrightarrow \sum_{i,j} a_{ij} E_{ij}E_{pq} = \sum_{i,j} a_{ij} E_{pq} E_{ij} 
    \leftrightarrow  \sum_{i,j} a_{ij} \delta_{jp} E_{iq} = \sum_{i,j} a_{ij} \delta_{qi} E_{pj} \leftrightarrow \sum_{i} a_{ip} E_{iq} = \sum_{j} a_{jp} E_{pj} \\
    \implies
    a_{pp} = a_{qq}  = \lambda \, \forall p,q \quad
    a_{ip} \, \forall i,p \, i\neq p
\end{gather*}
\end{sol}


\begin{prb}
Будем называть централизатором матрицы множество всех матриц, коммутирующих с данной. Найдите централизатор жордановой клетки $J(\lambda)$
\end{prb}

\begin{sol}
\begin{gather*}
    \mbox{Распишем условие коммутации матрицы} A \mbox{c жордановой клеткой.} \\
    A J(\lambda) = J(\lambda) A
\end{gather*}

\begin{gather*}
    J(\lambda) = \lambda E + J_{0} \\
    A (\lambda E + J_{0}) = (\lambda E + J_{0}) A 
    \mbox{ где } J_{0} = \left(\begin{array}{ccccc}
       0 & 1 & 0 & \cdots & 0\\
       0 & 0 & 1 & & 0 \\
       0 & 0 & 0 & 1& 0\\
       0 & & \ddots & 0 &1\\
       0 & 0 & \cdots & 0 & 0
    \end{array}\right)
\end{gather*}

\begin{gather*}
     A (\lambda E + J_{0}) = (\lambda E + J_{0}) A  \implies A + A J_{0} =
     J_{0}A + A \implies A J_{0} = J_{0} A 
\end{gather*}
То есть достаточно коммутации матрицы с $J_{0}$

Умножение слева на $J_{0}$ сдвигает матрицу на одну строчка вверх,
а умножение справа сдвигает на одну колонку вправо.


Проделав вычисления можно убедиться, что матрица $A$ должна быть одновременно вверхнетреугольной и матрицей Тёплица (Toeplitz) вида

\begin{gather*}
A = \begin{pmatrix}
a & b & c & \dots & A_n \\
  0 & a & b  & \dots & A_{n-1} \\
  0 & 0 & a  & \dots & A_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & 0 &\dots a \\
\end{pmatrix}
\end{gather*}
Полезно также отметить, что такая матрица является многочленом от $J(\lambda)$
\end{sol}

\begin{prb}
Посчитать $J(\lambda)^k$
\end{prb}

\begin{sol}
    \begin{gather*}
        J(\lambda)^k = (\lambda E + J_0)^k \\
        J_{0} \mbox{это нильпотентная матрица порядка $n$}
    \end{gather*}
    Так как $\left[\lambda E, J_0\right] = 0$
    можно использовать формулу бинома для матриц.
    $$
    \left(A + B \right)^{n} = \sum_{k=0}^nC_n^kA^kB^{n-k} 
    $$
    
    \begin{gather*}
     \left(\lambda E + J_0 \right)^{n} = \sum_{r=0}^{n} {{n}\choose{r}}\lambda^k J_{0}^{n-r}   =
    \end{gather*}
    
    \begin{gather*}
        J_k(\lambda)^n = \begin{pmatrix}
        \binom{n}{0}\lambda^n & \binom{n}{1}\lambda^{n-1} & \binom{n}{2}\lambda^{n-2} & \cdots & \cdots & \binom{n}{k-1}\lambda^{n-k+1} \\
         & \binom{n}{0}\lambda^n & \binom{n}{1}\lambda^{n-1} & \cdots & \cdots & \binom{n}{k-2}\lambda^{n-k+2} \\
         &  & \ddots & \ddots & \vdots & \vdots\\
         &  & & \ddots & \ddots & \vdots\\
         &  & &  & \binom{n}{0}\lambda^n & \binom{n}{1}\lambda^{n-1}\\
         &  &  &  &  & \binom{n}{0}\lambda^n
        \end{pmatrix}.
    \end{gather*}
\end{sol}

\begin{prb}
Пусть — квадратная нильпотентная матрица. Докажите, что матрицы $E + A$
и $E - A$ обратимы.
\end{prb}

\begin{sol}
    \begin{enumerate}
        \item[Решение 1]
        
            \begin{gather*}
                \left(E - A\right)^{-1} = \sum_{k = 0}^{\infty} A^{k} \\
                \left(E + A\right)^{-1} = \sum_{k = 0}^{\infty} (-1)^k A^{k}
            \end{gather*}
            Так как ряд матрица $A$ нильпотентна  этот формальный ряд обрывается на члене со степенью $n - 1$ где $n$ индекс нильпотентности.
            
            По построению такие ряды при умножение на $\left(E - A\right)$
            и $ \left(E + A\right)$ дают единичную матрицу.
            
        \item[Решение 2]
            Попробуем следующий трюк
            \begin{gather*}
                \left(E - A\right) \dot \left(E + A\right) \dot \left(E + A^2\right) \dots 
            \end{gather*}
            Очевидно что в какой-то итерации получится выражение вида $E -  A^k$ и где $k > n$
            Тогда получается, что 
            \begin{gather*}
                \left(E - A\right) \left[ \dots \right] = E -  A^k = E
            \end{gather*}
             Значит выражение в обратных скобках является обратной матрицей для $\left(E - A\right)$
    \end{enumerate}
\end{sol}

\begin{prb}
Пусть $A$ - нильпотентная матрица. Решите матричное уравнения
\begin{gather*}
    AX + X + A = 0
\end{gather*}
\end{prb}

\begin{sol}
    \begin{gather*}
         AX + X + A = 0 \\
        \left(A + E\right)X = -A \\
        X = - \left(A + E\right)^-1 A \\
        X = \sum_{k = 0}^{n - 1} (-1)^k A^{k} \cdot A = \sum_{k = 0}^{n - 2} (-1)^k A^{k + 1}
    \end{gather*}
\end{sol}

\begin{prb}
     Пусть $A$ — матрица порядка 2 с нулевым следом. Найдите централизатор
    матрицы $A^2$
\end{prb}

\begin{sol}
    \begin{gather*}
        \left[A^2, X\right] = 0
    \end{gather*}
    \begin{gather*}
    \mbox{Пусть } A = \left(\begin{array}{cc}
                a & b \\
                c & d
               \end{array}
               \right)
    \mbox{ Тогдa } A^2 = \left(
            \begin{array}{cc}
             a^2+b c & a b+b d \\
             a c+c d & b c+d^2 \\
            \end{array}
            \right)\\
    \mbox{При условии} \Tr A = 0   \\  
        A = \left(
            \begin{array}{cc}
             a^2+b c & 0 \\
             0 & b c+a^2 \\
            \end{array}
            \right) = (b c+a^2) E
    \end{gather*}
    Значит квадрат бесследовой матрицы пропорционален единичной.
    Так как с единичной матрицей коммутирует любая матрица из этого следует, что $X$ - произвольная матрица
\end{sol}


\begin{prb}
Определим коммутатор матриц $\left[A,B\right] = AB - BA$  . Докажите, что для любых матриц порядка 2 выполняется равенство
$\left[\left[A,B\right]^2,C\right] = 0$ 
\end{prb}

\begin{sol}
    Посчитаем $\Tr \left[A,B\right] = \Tr AB - \Tr BA  = 0$\\
    Значит любой коммутатор матриц $2 \times 2$ бесследовый, а значит его квадрат пропорционален единичной матриц. В предыдущей задачи мы доказали, что $C$ при таких условиях может быть произвольной.
\end{sol}

\begin{prb}
Докажите, что если матрица $A$ нильпотентна, а многочлен $f(x)$ имеет нену-
левой свободный член, то матрица $f(A)$ обратима.
\end{prb}
